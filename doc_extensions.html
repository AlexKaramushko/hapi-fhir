




 

 
 
 

     <!doctype html>
<!--
 Generated by Apache Maven Doxia  at 2019-11-12  Rendered using Reflow Maven Skin 2.0.0-beta2 (http://devacfr.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">
                                                                    
                    <head>
    <meta charset="UTF-8" />
    <title>Profiles and Extensions - HAPI FHIR</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="" />
    <meta name="author" content="James Agnew" />
      <meta http-equiv="content-language" content="en" />
                                                        <link href="https://netdna.bootstrapcdn.com/bootswatch/4.1.3/lumen/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
    <link href="./css/docs.css" rel="stylesheet" />
    <link href="./css/reflow-skin.css" rel="stylesheet" />

    <link href="./css/lightbox.css" rel="stylesheet" />
    <link href="./css/site.css" rel="stylesheet" />
    <link href="./css/print.css" rel="stylesheet" media="print" />
<!-- Syntax Highlighter -->
			<script type="text/javascript" src="syntaxhighlighter/shCore.js"></script>
			<script type="text/javascript" src="syntaxhighlighter/shBrushJScript.js"></script>
			<script type="text/javascript" src="syntaxhighlighter/shBrushJava.js"></script>
			<script type="text/javascript" src="syntaxhighlighter/shBrushBash.js"></script>
			<script type="text/javascript" src="syntaxhighlighter/shBrushXml.js"></script>
			
			<link href="syntaxhighlighter/shCore.css" rel="stylesheet" type="text/css" />
			<link href="syntaxhighlighter/shThemeDefault.css" rel="stylesheet" type="text/css" />
			
			<!-- 
			   HAPI stylesheet comes after because it overwrites the Syntax Highlighter
			   font size
			 -->
			<link rel="shortcut icon" href="http://hapifhir.io/favicon.png" />
			<link rel="stylesheet" type="text/css" href="hapi.css" />
        </head> <!-- end : head -->
<body class="page-doc_extensions project-hapi-fhir   scroll-top-smooth-enabled m-toc-sidebar-enabled m-toc-sidebar-expanded m-toc-sidebar-autoexpandable toc-sidebar-fixed">
    <nav id="m-top-navbar" class="navbar navbar-expand-lg fixed-top navbar-dark bg-primary border-bottom">
        <div class="container">
                                <a class="navbar-brand mb-0 h1" href="http://hapifhir.io"><span class="color-highlight">HAPI</span> FHIR</a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#top-navbar-collapse-1" aria-controls="top-navbar-collapse-1" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="top-navbar-collapse-1">
                <ul class="nav navbar-nav ml-auto">
<li class="nav-item " ><a     
     href="https://smilecdr.com"  title="Support"   class="externalLink nav-link" >Support</a></li>
<li class="nav-item " ><a     
     href="download.html"  title="Download"  class="nav-link" >Download</a></li>
<li class="nav-item " ><a     
     href="https://github.com/jamesagnew/hapi-fhir"  title="GitHub Project"   class="externalLink nav-link" >GitHub Project</a></li>
                            <li class="nav-item dropdown active">
                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Documentation <b class="caret"></b></a>
                <div class="dropdown-menu">
                    <a href="docindex.html" title="Documentation Index"  class="dropdown-item ">Documentation Index</a>
                    <a href="doc_intro.html" title="Introduction"  class="dropdown-item ">Introduction</a>
                    <a href="doc_dstu2.html" title="DSTU3 Support / HL7.org Structures"  class="dropdown-item ">DSTU3 Support / HL7.org Structures</a>
                    <div class="dropdown-submenu ">
    <a     
     href="doc_fhirobjects.html"  title="The Data Model"  class="dropdown-item" >The Data Model</a>                        <div class="dropdown-menu">
                                <a href="doc_fhirobjects.html" title="Working with Resources"  class="dropdown-item ">Working with Resources</a>
                                <a href="doc_resource_references.html" title="Resource References"  class="dropdown-item ">Resource References</a>
                                                <a href="" title="Profiles & Extensions"  class="dropdown-item active">Profiles & Extensions</a>
                                <a href="doc_tags.html" title="Tags"  class="dropdown-item ">Tags</a>
                                <a href="doc_validation.html" title="Validation"  class="dropdown-item ">Validation</a>
                                <a href="doc_custom_structures.html" title="Custom Structures"  class="dropdown-item ">Custom Structures</a>
                                <a href="doc_converter.html" title="Version Converter"  class="dropdown-item ">Version Converter</a>
                            </div>
                    </div>
                    <div class="dropdown-submenu ">
    <a     
     href="doc_rest_client.html"  title="RESTful Client"  class="dropdown-item" >RESTful Client</a>                        <div class="dropdown-menu">
                                <a href="doc_rest_client.html" title="Fluent/Generic Client"  class="dropdown-item ">Fluent/Generic Client</a>
                                <a href="doc_rest_client_annotation.html" title="Annotation Client"  class="dropdown-item ">Annotation Client</a>
                                <a href="doc_rest_client_interceptor.html" title="Interceptors (client)"  class="dropdown-item ">Interceptors (client)</a>
                                <a href="doc_rest_client_http_config.html" title="Client Configuration"  class="dropdown-item ">Client Configuration</a>
                                <a href="doc_rest_client_examples.html" title="Client Examples"  class="dropdown-item ">Client Examples</a>
                                <a href="doc_rest_client_alternate_provider.html" title="JAX-RS Client & Alternate HTTP Providers"  class="dropdown-item ">JAX-RS Client & Alternate HTTP Providers</a>
                            </div>
                    </div>
                    <div class="dropdown-submenu ">
    <a     
     href="doc_rest_server.html"  title="RESTful Server"  class="dropdown-item" >RESTful Server</a>                        <div class="dropdown-menu">
                                <a href="doc_rest_server.html" title="Using RESTful Server"  class="dropdown-item ">Using RESTful Server</a>
                                <a href="doc_rest_operations.html" title="RESTful Operations"  class="dropdown-item ">RESTful Operations</a>
                                <a href="doc_narrative.html" title="Narrative Generator"  class="dropdown-item ">Narrative Generator</a>
                                <a href="doc_rest_server_interceptor.html" title="Interceptors (server)"  class="dropdown-item ">Interceptors (server)</a>
                                <a href="doc_rest_server_security.html" title="Security"  class="dropdown-item ">Security</a>
                                <a href="doc_cors.html" title="CORS Support"  class="dropdown-item ">CORS Support</a>
                                <a href="doc_server_tester.html" title="Web Testing UI"  class="dropdown-item ">Web Testing UI</a>
                                <a href="doc_rest_server_jaxrs.html" title="JAX-RS Support"  class="dropdown-item ">JAX-RS Support</a>
                            </div>
                    </div>
                    <a href="doc_logging.html" title="Logging"  class="dropdown-item ">Logging</a>
                    <a href="doc_rest_etag.html" title="ETags"  class="dropdown-item ">ETags</a>
                    <a href="doc_jpa.html" title="JPA/Database Server"  class="dropdown-item ">JPA/Database Server</a>
                    <a href="doc_android.html" title="Android Support"  class="dropdown-item ">Android Support</a>
                    <div class="dropdown-submenu ">
    <a     
     href="apidocs/index.html"  title="JavaDocs"  class="dropdown-item" >JavaDocs</a>                        <div class="dropdown-menu">
                                <a href="apidocs/index.html" title="Core API"  class="dropdown-item ">Core API</a>
                                <a href="apidocs-dstu2/index.html" title="Model API (DSTU2)"  class="dropdown-item ">Model API (DSTU2)</a>
                                <a href="apidocs-dstu3/index.html" title="Model API (DSTU3)"  class="dropdown-item ">Model API (DSTU3)</a>
                                <a href="apidocs-r4/index.html" title="Model API (R4)"  class="dropdown-item ">Model API (R4)</a>
                                <a href="apidocs-client/index.html" title="Client API"  class="dropdown-item ">Client API</a>
                                <a href="apidocs-server/index.html" title="Server API (Plain)"  class="dropdown-item ">Server API (Plain)</a>
                                <a href="apidocs-jpaserver/index.html" title="Server API (JPA)"  class="dropdown-item ">Server API (JPA)</a>
                            </div>
                    </div>
                    <a href="doc_cli.html" title="Command Line Tool (hapi-fhir-cli)"  class="dropdown-item ">Command Line Tool (hapi-fhir-cli)</a>
                    <a href="doc_tinder.html" title="Maven Plugin (hapi-tinder-plugin)"  class="dropdown-item ">Maven Plugin (hapi-tinder-plugin)</a>
                </div>
            </li>
            <li class="nav-item dropdown">
                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Get Help <b class="caret"></b></a>
                <div class="dropdown-menu">
                    <a href="https://github.com/jamesagnew/hapi-fhir/wiki/Getting-Help" title="How to Ask for Help (read this first!)"  class="dropdown-item ">How to Ask for Help (read this first!)</a>
                    <a href="https://groups.google.com/d/forum/hapi-fhir" title="Google Group (Ask Questions)"  class="dropdown-item ">Google Group (Ask Questions)</a>
                    <a href="https://github.com/jamesagnew/hapi-fhir/issues" title="Issue Tracker (Report Bugs/Request Features)"  class="dropdown-item ">Issue Tracker (Report Bugs/Request Features)</a>
                    <a href="https://chat.fhir.org" title="FHIR.org Chat (Live Chat with FHIR Implementors)"  class="dropdown-item ">FHIR.org Chat (Live Chat with FHIR Implementors)</a>
                    <a href="hapi-fhir-faq.html" title="Frequently Asked Questions (FAQ)"  class="dropdown-item ">Frequently Asked Questions (FAQ)</a>
                </div>
            </li>
            <li class="nav-item dropdown">
                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Test Server <b class="caret"></b></a>
                <div class="dropdown-menu">
                    <a href="http://hapi.fhir.org" title="Public Test Server"  class="dropdown-item ">Public Test Server</a>
                </div>
            </li>
                </ul><!--/ul.navbar-nav -->
            </div><!--/.nav-collapse -->
        </div> <!--/.container -->
    </nav> <!--/.navbar -->
    <div class="main-body container-fuild my-3">
    <div class="row m-0">
        <div class="d-xs-none d-sm-none d-md-none d-lg-block col-lg-2">
        </div>
        <main class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-8" role="main">
            <div class="header container-fluid">
                                     <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a     
     href="index.html"  title="HAPI FHIR"  class="" >HAPI FHIR</a></li>
            <li class="breadcrumb-item active">Profiles and Extensions</li>

        </ol>
    </nav>
            </div> <!-- end : header -->
                             <div class="section"> 
 <div class="page-header">
  <h2 id="_toc_undeclared_extensions">Undeclared Extensions</h2>
 </div> 
 <p class="doc_info_bubble"> Note on FHIR Versions: Because of the differences in the way the structures work between DSTU2 and DSTU3, we have provided two versions of many of the examples on this page. See the <a href="./download.html">download page</a> for more information on FHIR versions. </p> 
 <p> Extensions are a key part of the FHIR specification, providing a standardized way of placing additional data in a resource. </p> 
 <p> The simplest way to interact with extensions (i.e. to add them to resources you are creating, or to read them from resources you are consuming) is to treat them as "undeclared extensions". Undeclared extensions can be added to any of the built in FHIR resource types that come with HAPI-FHIR. </p> 
 <p> <b>DSTU2</b> </p> 
 <div class="source"> 
  <pre>// Create an example patient
Patient patient = new Patient();
patient.addIdentifier().setUse(IdentifierUseEnum.OFFICIAL).setSystem("urn:example").setValue("7000135");

// Create an extension
ExtensionDt ext = new ExtensionDt();
ext.setModifier(false);
ext.setUrl("http://example.com/extensions#someext");
ext.setValue(new DateTimeDt("2011-01-02T11:13:15"));

// Add the extension to the resource
patient.addUndeclaredExtension(ext);
</pre> 
 </div> 
 <p> <b>DSTU3</b> </p> 
 <div class="source"> 
  <pre>// Create an example patient
Patient patient = new Patient();
patient.addIdentifier().setUse(IdentifierUse.OFFICIAL).setSystem("urn:example").setValue("7000135");

// Create an extension
Extension ext = new Extension();
ext.setUrl("http://example.com/extensions#someext");
ext.setValue(new DateTimeType("2011-01-02T11:13:15"));

// Add the extension to the resource
patient.addExtension(ext);
</pre> 
 </div> 
 <p> Undeclared extensions can also be added to datatypes (composite or primitive). </p> 
 <p> <b>DSTU2</b> </p> 
 <div class="source"> 
  <pre>// Continuing the example from above, we will add a name to the patient, and then
// add an extension to part of that name
HumanNameDt name = patient.addName();
name.addFamily().setValue("Shmoe");

// Add a new "given name", which is of type StringDt 
StringDt given = name.addGiven();
given.setValue("Joe");

// Create an extension and add it to the StringDt
ExtensionDt givenExt = new ExtensionDt(false, "http://examples.com#moreext", new StringDt("Hello"));
given.addUndeclaredExtension(givenExt);
</pre> 
 </div> 
 <p> <b>DSTU3</b> </p> 
 <div class="source"> 
  <pre>// Continuing the example from above, we will add a name to the patient, and then
// add an extension to part of that name
HumanName name = patient.addName();
name.setFamily("Shmoe");

// Add a new "given name", which is of type String 
StringType given = name.addGivenElement();
given.setValue("Joe");

// Create an extension and add it to the String
Extension givenExt = new Extension("http://examples.com#moreext", new StringType("Hello"));
given.addExtension(givenExt);
</pre> 
 </div> 
 <div class="section"> 
  <h3 id="_toc_sub-extensions">Sub-Extensions</h3> 
  <p> Extensions may also have child extensions as their content, instead of a datatype. This is done by adding a child undeclared extension to the parent extension. </p> 
  <p> <b>DSTU2</b> </p> 
  <div class="source"> 
   <pre>Patient patient = new Patient();

// Add an extension (initially with no contents) to the resource 
ExtensionDt parent = new ExtensionDt(false, "http://example.com#parent");
patient.addUndeclaredExtension(parent);

// Add two extensions as children to the parent extension
ExtensionDt child1 = new ExtensionDt(false, "http://example.com#childOne", new StringDt("value1"));
parent.addUndeclaredExtension(child1);

ExtensionDt child2 = new ExtensionDt(false, "http://example.com#childTwo", new StringDt("value1"));
parent.addUndeclaredExtension(child2);
</pre> 
  </div> 
  <p> <b>DSTU3</b> </p> 
  <div class="source"> 
   <pre>Patient patient = new Patient();

// Add an extension (initially with no contents) to the resource 
Extension parent = new Extension("http://example.com#parent");
patient.addExtension(parent);

// Add two extensions as children to the parent extension
Extension child1 = new Extension("http://example.com#childOne", new StringType("value1"));
parent.addExtension(child1);

Extension child2 = new Extension("http://example.com#chilwo", new StringType("value1"));
parent.addExtension(child2);
</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="_toc_retrieving_extension_values">Retrieving Extension Values</h3> 
  <p> HAPI provides a few ways of accessing extension values in resources which are received from other sources (i.e. downloaded by a client). </p> 
  <p> <b>DSTU2</b> </p> 
  <div class="source"> 
   <pre>// Get all extensions (modifier or not) for a given URL
List&lt;ExtensionDt&gt; resourceExts = patient.getUndeclaredExtensionsByUrl("http://fooextensions.com#exts");

// Get all non-modifier extensions regardless of URL
List&lt;ExtensionDt&gt; nonModExts = patient.getUndeclaredExtensions();

//Get all non-modifier extensions regardless of URL
List&lt;ExtensionDt&gt; modExts = patient.getUndeclaredModifierExtensions();
</pre> 
  </div> 
  <p> <b>DSTU3</b> </p> 
  <div class="source"> 
   <pre>// Get all extensions (modifier or not) for a given URL
List&lt;Extension&gt; resourceExts = patient.getExtensionsByUrl("http://fooextensions.com#exts");

// Get all non-modifier extensions regardless of URL
List&lt;Extension&gt; nonModExts = patient.getExtension();

//Get all non-modifier extensions regardless of URL
List&lt;Extension&gt; modExts = patient.getModifierExtension();
</pre> 
  </div> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="_toc_custom_resource_types">Custom Resource Types</h2> 
 <p> The most elegant way of adding extensions to a resource is through the use of custom fields. The following example shows a custom type which extends the FHIR Patient resource definition through two extensions. </p> 
 <div class="source"> 
  <pre>import java.util.ArrayList;
import java.util.List;

import org.hl7.fhir.dstu3.model.DateTimeType;
import org.hl7.fhir.dstu3.model.Patient;
import org.hl7.fhir.dstu3.model.StringType;

import ca.uhn.fhir.model.api.annotation.Child;
import ca.uhn.fhir.model.api.annotation.Description;
import ca.uhn.fhir.model.api.annotation.Extension;
import ca.uhn.fhir.model.api.annotation.ResourceDef;
import ca.uhn.fhir.util.ElementUtil;

/**
 * Definition class for adding extensions to the built-in
 * Patient resource type.
 * 
 * Note the "profile" attribute below, which indicates the URL/ID of the
 * profile implemented by this resource. You are not required to supply this,
 * but if you do it will be automatically populated in the resource meta
 * tag if the resource is returned by a server.
 */
@ResourceDef(name="Patient", profile="http://example.com/StructureDefinition/mypatient")
public class MyPatient extends Patient {

   private static final long serialVersionUID = 1L;

   /**
	 * Each extension is defined in a field. Any valid HAPI Data Type
	 * can be used for the field type. Note that the [name=""] attribute
	 * in the @Child annotation needs to match the name for the bean accessor
	 * and mutator methods.
	 */
	@Child(name="petName")	
	@Extension(url="http://example.com/dontuse#petname", definedLocally=false, isModifier=false)
	@Description(shortDefinition="The name of the patient's favourite pet")
	private StringType myPetName;

	/**
	 * The second example extension uses a List type to provide
	 * repeatable values. Note that a [max=] value has been placed in
	 * the @Child annotation.
	 * 
	 * Note also that this extension is a modifier extension
	 */
	@Child(name="importantDates", max=Child.MAX_UNLIMITED)	
	@Extension(url="http://example.com/dontuse#importantDates", definedLocally=false, isModifier=true)
	@Description(shortDefinition="Some dates of note for this patient")
	private List&lt;DateTimeType&gt; myImportantDates;

	/**
	 * It is important to override the isEmpty() method, adding a check for any
	 * newly added fields. 
	 */
	@Override
	public boolean isEmpty() {
		return super.isEmpty() &amp;&amp; ElementUtil.isEmpty(myPetName, myImportantDates);
	}
	
	/********
	 * Accessors and mutators follow
	 * 
	 * IMPORTANT:
	 * Each extension is required to have an getter/accessor and a stter/mutator. 
	 * You are highly recommended to create getters which create instances if they
	 * do not already exist, since this is how the rest of the HAPI FHIR API works. 
	 ********/
	
	/** Getter for important dates */
	public List&lt;DateTimeType&gt; getImportantDates() {
		if (myImportantDates==null) {
			myImportantDates = new ArrayList&lt;DateTimeType&gt;();
		}
		return myImportantDates;
	}

	/** Getter for pet name */
	public StringType getPetName() {
		if (myPetName == null) {
			myPetName = new StringType();
		}
		return myPetName;
	}

	/** Setter for important dates */
	public void setImportantDates(List&lt;DateTimeType&gt; theImportantDates) {
		myImportantDates = theImportantDates;
	}

	/** Setter for pet name */
	public void setPetName(StringType thePetName) {
		myPetName = thePetName;
	}

}
</pre> 
 </div> 
 <p> Using this custom type is as simple as instantiating the type and working with the new fields. </p> 
 <div class="source"> 
  <pre>MyPatient patient = new MyPatient();
patient.setPetName(new StringDt("Fido"));
patient.getImportantDates().add(new DateTimeDt("2010-01-02"));
patient.getImportantDates().add(new DateTimeDt("2014-01-26T11:11:11"));

patient.addName().addFamily("Smith").addGiven("John").addGiven("Quincy").addSuffix("Jr");

IParser p = FhirContext.forDstu2().newXmlParser().setPrettyPrint(true);
String messageString = p.encodeResourceToString(patient);

System.out.println(messageString);
</pre> 
 </div> 
 <p> This example produces the following output: </p> 
 <div class="source"> 
  <pre>&lt;Patient xmlns="http://hl7.org/fhir"&gt;
   &lt;modifierExtension url="http://example.com/dontuse#importantDates"&gt;
      &lt;valueDateTime value="2010-01-02"/&gt;
   &lt;/modifierExtension&gt;
   &lt;modifierExtension url="http://example.com/dontuse#importantDates"&gt;
      &lt;valueDateTime value="2014-01-26T11:11:11"/&gt;
   &lt;/modifierExtension&gt;
   &lt;extension url="http://example.com/dontuse#petname"&gt;
      &lt;valueString value="Fido"/&gt;
   &lt;/extension&gt;
   &lt;name&gt;
      &lt;family value="Smith"/&gt;
      &lt;given value="John"/&gt;
      &lt;given value="Quincy"/&gt;
      &lt;suffix value="Jr"/&gt;
   &lt;/name&gt;
&lt;/Patient&gt;</pre> 
 </div> 
 <p> Parsing messages using your new custom type is equally simple. These types can also be used as method return types in clients and servers. </p> 
 <div class="source"> 
  <pre>IParser parser = FhirContext.forDstu2().newXmlParser();
MyPatient newPatient = parser.parseResource(MyPatient.class, messageString);
</pre> 
 </div> 
 <div class="section"> 
  <h3 id="_toc_using_custom_types_in_a_client">Using Custom Types in a Client</h3> 
  <p> If you are using a client and wish to use a specific custom structure, you may simply use the custom structure as you would a build in HAPI type. </p> 
  <div class="source"> 
   <pre>// Create an example patient
MyPatient custPatient = new MyPatient();
custPatient.addName().setFamily("Smith").addGiven("John");
custPatient.setPetName(new StringType("Rover")); // populate the extension

// Create the resource like normal
client.create().resource(custPatient).execute();

// You can also read the resource back like normal
custPatient = client.read().resource(MyPatient.class).withId("123").execute();
</pre> 
  </div> 
  <p> You may also explicitly use custom types in searches and other operations which return resources. </p> 
  <div class="source"> 
   <pre>// Perform the search using the custom type
Bundle bundle = client
   .search()
   .forResource(MyPatient.class)
   .returnBundle(Bundle.class)
   .execute();

// Entries in the return bundle will use the given type
MyPatient pat0 = (MyPatient) bundle.getEntry().get(0).getResource();
</pre> 
  </div> 
  <p> You can also explicitly declare a preferred response resource custom type. This is useful for some operations that do not otherwise declare their resource types in the method signature. </p> 
  <div class="source"> 
   <pre>//Perform the search using the custom type
bundle = client
   .history()
   .onInstance(new IdType("Patient/123"))
   .andReturnBundle(Bundle.class)
   .preferResponseType(MyPatient.class)
   .execute();

//Entries in the return bundle will use the given type
MyPatient historyPatient0 = (MyPatient) bundle.getEntry().get(0).getResource();
</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="_toc_using_multiple_custom_types_in_a_client">Using Multiple Custom Types in a Client</h3> 
  <p> Sometimes you may not know in advance exactly which type you will be receiving. For example, there are Patient resources which conform to several different profiles on a server and you aren't sure which profile you will get back for a specific read, you can declare the "primary" type for a given profile. </p> 
  <p> This is declared at the FhirContext level, and will apply to any clients created from this context (including clients created before the default was set). </p> 
  <div class="source"> 
   <pre>FhirContext ctx = FhirContext.forDstu3();

// Instruct the context that if it receives a resource which
// claims to conform to the given profile (by URL), it should
// use the MyPatient type to parse this resource
ctx.setDefaultTypeForProfile("http://example.com/StructureDefinition/mypatient", MyPatient.class);

// You can declare as many default types as you like
ctx.setDefaultTypeForProfile("http://foo.com/anotherProfile", CustomObservation.class);

// Create a client
IGenericClient client = ctx.newRestfulGenericClient("http://fhirtest.uhn.ca/baseDstu3");

// You can also read the resource back like normal
Patient patient = client.read().resource(Patient.class).withId("123").execute();
if (patient instanceof MyPatient) {
   // If the server supplied a resource which declared to conform
   // to the given profile, MyPatient will have been returned so
   // process it differently..
}

</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="_toc_using_custom_types_in_a_server">Using Custom Types in a Server</h3> 
  <p> If you are using a client and wish to use a specific custom structure, you may simply use the custom structure as you would a build in HAPI type. </p> 
  <div class="source"> 
   <pre>// Create an example patient
MyPatient custPatient = new MyPatient();
custPatient.addName().setFamily("Smith").addGiven("John");
custPatient.setPetName(new StringType("Rover")); // populate the extension

// Create the resource like normal
client.create().resource(custPatient).execute();

// You can also read the resource back like normal
custPatient = client.read().resource(MyPatient.class).withId("123").execute();
</pre> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="_toc_custom_type_examples_composite_extensions">Custom Type Examples: Composite Extensions</h3> 
  <p> The following example shows a resource containing a composite extension. </p> 
  <div class="source"> 
   <pre>@ResourceDef(name = "Patient")
public class CustomCompositeExtension extends Patient {

	private static final long serialVersionUID = 1L;

	/**
	 * A custom extension
	 */
	@Child(name = "foo")
	@Extension(url="http://acme.org/fooParent", definedLocally = false, isModifier = false)
	protected FooParentExtension fooParentExtension;

	public FooParentExtension getFooParentExtension() {
		return fooParentExtension;
	}

	@Override
	public boolean isEmpty() {
		return super.isEmpty() &amp;&amp; ElementUtil.isEmpty(fooParentExtension);
	}

	public void setFooParentExtension(FooParentExtension theFooParentExtension) {
		fooParentExtension = theFooParentExtension;
	}

	@Block
	public static class FooParentExtension extends BackboneElement {

		private static final long serialVersionUID = 4522090347756045145L;

		@Child(name = "childA")
		@Extension(url = "http://acme.org/fooChildA", definedLocally = false, isModifier = false)
		private StringType myChildA;

		@Child(name = "childB")
		@Extension(url = "http://acme.org/fooChildB", definedLocally = false, isModifier = false)
		private StringType myChildB;

		@Override
		public FooParentExtension copy() {
			FooParentExtension copy = new FooParentExtension();
			copy.myChildA = myChildA;
			copy.myChildB = myChildB;
			return copy;
		}

		@Override
		public boolean isEmpty() {
			return super.isEmpty() &amp;&amp; ElementUtil.isEmpty(myChildA, myChildB);
		}

		public StringType getChildA() {
			return myChildA;
		}

		public StringType getChildB() {
			return myChildB;
		}

		public void setChildA(StringType theChildA) {
			myChildA = theChildA;
		}

		public void setChildB(StringType theChildB) {
			myChildB = theChildB;
		}

	}

}
</pre> 
  </div> 
  <p> This could be used to create a resource such as the following: </p> 
  <div class="source"> 
   <pre>&lt;Patient xmlns="http://hl7.org/fhir"&gt;
   &lt;id value="123"/&gt;
   &lt;extension url="http://acme.org/fooParent"&gt;
      &lt;extension url="http://acme.org/fooChildA"&gt;
         &lt;valueString value="ValueA"/&gt;
      &lt;/extension&gt;
      &lt;extension url="http://acme.org/fooChildB"&gt;
         &lt;valueString value="ValueB"/&gt;
      &lt;/extension&gt;
   &lt;/extension&gt;
&lt;/Patient&gt;</pre> 
  </div> 
 </div> 
</div>                    </main>
        <div class="d-none d-sm-none d-md-none d-lg-none d-xl-block col-xl-2">
                        <div id="m-toc-sidebar" class="d-print-none m-toc-sidebar-enabled m-toc-sidebar-expanded m-toc-sidebar-autoexpandable toc-sidebar-fixed">
                <nav id="m-toc-sidebar-nav flex-column">
                <ul class="m-nav--sidebar nav flex-column flex-nowrap">
    <li class="h2">
        <a class="nav-link" href="#_toc_undeclared_extensions" title="Undeclared Extensions">Undeclared Extensions</a>
    </li>
    <ul class="nav flex-column flex-nowrap nav-collapsible">
        <li class="h3">
        <a class="nav-link" href="#_toc_sub-extensions" title="Sub-Extensions">Sub-Extensions</a>
    </li>
    <li class="h3">
        <a class="nav-link" href="#_toc_retrieving_extension_values" title="Retrieving Extension Values">Retrieving Extension Values</a>
    </li>
    </ul>
        <li class="h2">
        <a class="nav-link" href="#_toc_custom_resource_types" title="Custom Resource Types">Custom Resource Types</a>
    </li>
    <ul class="nav flex-column flex-nowrap nav-collapsible">
        <li class="h3">
        <a class="nav-link" href="#_toc_using_custom_types_in_a_client" title="Using Custom Types in a Client">Using Custom Types in a Client</a>
    </li>
    <li class="h3">
        <a class="nav-link" href="#_toc_using_multiple_custom_types_in_a_client" title="Using Multiple Custom Types in a Client">Using Multiple Custom Types in a Client</a>
    </li>
    <li class="h3">
        <a class="nav-link" href="#_toc_using_custom_types_in_a_server" title="Using Custom Types in a Server">Using Custom Types in a Server</a>
    </li>
    <li class="h3">
        <a class="nav-link" href="#_toc_custom_type_examples_composite_extensions" title="Custom Type Examples: Composite Extensions">Custom Type Examples: Composite Extensions</a>
    </li>
    </ul>
                    </ul>
                </nav>
           </div>
            </div>
    </div> <!-- row: end -->
</div> <!-- .main-body: end -->
    <div id="m-scroll-top" style="display: none;">
        <a href="javascript:;">
            <div class="arrow"></div>
            <div class="stick"></div>
        </a>
    </div>
  <!-- Footer -->
  <footer class="footer-light bg-light">
    <div class="container">
        <div class="row">
        
            <div class="col bottom-nav">

                <ul class="nav flex-column nav-list">
                    <li class="nav-header">HAPI FHIR                    </li>
                    <li class="nav-item " )><a     
     href="index.html"  title="Home"  class="nav-link" >Home</a></li>
                    <li class="nav-item " )><a     
     href="download.html"  title="Download"  class="nav-link" >Download</a></li>
                    <li class="nav-item " )><a     
     href="changes-report.html"  title="Changelog"  class="nav-link" >Changelog</a></li>
                    <li class="nav-item " )><a     
     href="license.html"  title="License"  class="nav-link" >License</a></li>
                    <li class="nav-header">Test Server                    </li>
                    <li class="nav-item " )><a     
     href="http://hapi.fhir.org"  title="Public Test Server"   class="externalLink nav-link" >Public Test Server</a></li>
                </ul>
            </div>
            <div class="col bottom-nav">

                <ul class="nav flex-column nav-list">
                    <li class="nav-header">Using HAPI                    </li>
                    <li class="nav-item " )><a     
     href="docindex.html"  title="Documentation Index"  class="nav-link" >Documentation Index</a></li>
                    <li class="nav-item " )><a     
     href="doc_cli.html"  title="Command Line Tool (cli)"  class="nav-link" >Command Line Tool (cli)</a></li>
                    <li class="nav-header">Contribute                    </li>
                    <li class="nav-item " )><a     
     href="hacking_hapi_fhir.html"  title="Guide to Hacking HAPI"  class="nav-link" >Guide to Hacking HAPI</a></li>
                </ul>
            </div>
            <div class="col bottom-nav">

                <ul class="nav flex-column nav-list">
                    <li class="nav-header">JavaDocs                    </li>
                    <li class="nav-item " )><a     
     href="apidocs/index.html"  title="Core API"  class="nav-link" >Core API</a></li>
                    <li class="nav-item " )><a     
     href="apidocs-dstu/index.html"  title="Model API (DSTU1)"  class="nav-link" >Model API (DSTU1)</a></li>
                    <li class="nav-item " )><a     
     href="apidocs-dstu2/index.html"  title="Model API (DSTU2)"  class="nav-link" >Model API (DSTU2)</a></li>
                    <li class="nav-item " )><a     
     href="apidocs-dstu3/index.html"  title="Model API (DSTU3)"  class="nav-link" >Model API (DSTU3)</a></li>
                    <li class="nav-item " )><a     
     href="apidocs-r4/index.html"  title="Model API (R4)"  class="nav-link" >Model API (R4)</a></li>
                    <li class="nav-item " )><a     
     href="apidocs-client/index.html"  title="Client API"  class="nav-link" >Client API</a></li>
                    <li class="nav-item " )><a     
     href="apidocs-server/index.html"  title="Server API (Plain)"  class="nav-link" >Server API (Plain)</a></li>
                    <li class="nav-item " )><a     
     href="apidocs-jpaserver/index.html"  title="Server API (JPA)"  class="nav-link" >Server API (JPA)</a></li>
                    <li class="nav-header">JXR                    </li>
                    <li class="nav-item " )><a     
     href="xref-base/index.html"  title="Core"  class="nav-link" >Core</a></li>
                    <li class="nav-item " )><a     
     href="xref-jpaserver/index.html"  title="JPA Server"  class="nav-link" >JPA Server</a></li>
                </ul>
            </div>
            <div class="col bottom-nav">

                <ul class="nav flex-column nav-list">
                    <li class="nav-header">Get Help                    </li>
                    <li class="nav-item " )><a     
     href="https://github.com/jamesagnew/hapi-fhir/wiki/Getting-Help"  title="How to Ask for Help (read this first!)"   class="externalLink nav-link" >How to Ask for Help (read this first!)</a></li>
                    <li class="nav-item " )><a     
     href="https://groups.google.com/d/forum/hapi-fhir"  title="Google Group (Ask Questions)"   class="externalLink nav-link" >Google Group (Ask Questions)</a></li>
                    <li class="nav-item " )><a     
     href="https://github.com/jamesagnew/hapi-fhir/issues"  title="Issue Tracker (Report Bugs/Request Features)"   class="externalLink nav-link" >Issue Tracker (Report Bugs/Request Features)</a></li>
                    <li class="nav-item " )><a     
     href="https://chat.fhir.org"  title="FHIR.org Chat (Live Chat with FHIR Implementors)"   class="externalLink nav-link" >FHIR.org Chat (Live Chat with FHIR Implementors)</a></li>
                    <li class="nav-item " )><a     
     href="hapi-fhir-faq.html"  title="Frequently Asked Questions (FAQ)"  class="nav-link" >Frequently Asked Questions (FAQ)</a></li>
                </ul>
            </div>
        <div class="col bottom-description">
            <blockquote class="blockquote">HAPI FHIR is a Java implementation of the HL7 FHIR
				(Fast Healthcare Interoperable Resources) specification.
				This project is open source (licensed under the Apache Software
				License 2.0) and 100% free to use.<br/><br/>
				<a href="https://github.com/jamesagnew/hapi-fhir"><img src="./images/github-logo-mini.png" alt="Hosted on GitHub" border="0"/></a>
				<br/>
				Star us and we will love you!<br />
				<iframe src="https://ghbtns.com/github-btn.html?user=jamesagnew&repo=hapi-fhir&type=star&count=true" frameborder="0" scrolling="0" width="100px" height="20px"></iframe></blockquote>
        </div>
      </div>
    </div>
  </footer>
  <div class="container subfooter">
    <div class="row">
      <div class="col-md-12">
        <p class="copyright">Copyright &copy;2014-2019                 <a href="http://www.uhn.ca">University Health Network</a>
. All Rights Reserved.</p>
        <p class="version-date">
<span class="projectVersion">Version: 4.1.0. </span><span class="publishDate">
    Last Published: 2019-11-12
. </span>        </p>
        <p><a href="https://github.com/devacfr/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://devacfr.github.io" target="_blank" title="devacfr">devacfr</a>.</p>
      </div>
    </div>
  </div>

  <!-- Le javascript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/${popperVersion}/umd//popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>

  <script src="./js/lightbox.min.js"></script>
      <script src="./js/reflow-skin.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.2/anchor.min.js"></script>
    <script type="text/javascript">
	var elements = document.getElementsByClassName("source");
	for (var i=0; i < elements.length; i++) {
		var pres = elements[i].getElementsByTagName("pre");
		for (var j = 0; j < pres.length; j++) {
			var pre = pres[j];
			if (pre.innerHTML.match(/^\s*\&lt\;/)) {
				pre.className = 'brush: xml';
			} else if (pre.innerHTML.match(/\/\*/)) {
				pre.className = 'brush: java';
			} else if (pre.innerHTML.match(/^\/\//)) {
				pre.className = 'brush: java';
			} else if (pre.innerHTML.match(/^\{/)) {
				pre.className = 'brush: jscript';
			} else if (pre.innerHTML.match(/^\#/)) {
				pre.className = 'brush: bash';
			} else if (pre.innerHTML.match(/\&lt\;\//)) {
				pre.className = 'brush: xml';
			} else {
				pre.className = 'brush: java';
			}
		}
	}

	SyntaxHighlighter.all();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-1395874-5', 'auto');
  ga('require', 'displayfeatures');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');

</script>
                </body >
</html>